
# Open Source, wie es sein soll

Published at: **2019-11-05T06:00:01+00:00**

Author: **Sebastian Grüner**

Original: [Golem.de](https://www.golem.de/news/gardena-open-source-wie-es-sein-soll-1911-144722.html)

Das Gateway des Smart Home System von Gardena steuert zentral verschiedene mehr oder weniger smarte Gartengeräte des Marktführers. Trotz anfänglich großer Probleme ist die zugehörige Software inzwischen auf einem Stand, der aus Sicht der Linux-Community sowie der Nutzer als absolut erstrebenswert bezeichnet werden kann. Wie es dazu gekommen ist, haben die beiden zuständigen Entwickler Andreas Müller und Reto Schneider auf dem Open Source Summit in Lyon berichtet.
Mit ihrer Geschichte wollen sie offenbar als eine Art Vorbild dienen: "Zeigt diesen Vortrag eurem Management!", forderten sie das Publikum auf. Ihren Weg mit und an der Software nennen die Entwickler in Anlehnung an den Call-for-Papers "Kriegserzählung" - was natürlich nur im übertragenen Sinne und als Kategorie für hart erarbeitete Erfahrungen zu verstehen ist.
So entdeckte Golem.de im Frühjahr 2016 beim Test des Gardena Smart System noch einige Hindernisse, die vor allem auf die Software zurückzuführen waren. Und das Unternehmen hatte - leider nicht unüblich - damals auch klar gegen die Lizenzbedingungen des genutzten Linux-Codes verstoßen.
Für die zweite Generation des Geräts wollte das Team von Anfang an alles richtig machen - aus eigener Motivation heraus - wie die beiden mehrfach betonten. Das Thema Open Source wurde in der Führungsetage von Gardena laut Schneider und Müller eher mit Desinteresse und niedriger Priorität behandelt. Daher musste der Open-Source-Ansatz für das Gerät von Grund auf gestaltet werden.
Kritisch für das Projekt war zusätzlich der Zwang, den geplanten Fertigstellungstermin einzuhalten. Denn eine Verschiebung des Marktstarts eines Geräts kann und will sich der Marktführer nicht leisten. Vom Projektstart bis zum geplanten Verkaufsstart hatte das Team nur ein Jahr Zeit, "einen Backup-Plan gab es nicht", heißt es im Vortrag der Entwickler. In einem anschließenden Gespräch mit Golem.de sagte Schneider außerdem: "Open Source hat uns mehr als einmal gerettet".
Dafür musste jedoch auch erst für das richtige Verständnis im Unternehmen gesorgt werden. So stellte uns Gardena für die erste Generation des Geräts den unter GPL stehenden Quellcode damals nicht zur Verfügung und war auf entsprechende Anfragen auch nicht vorbereitet. Wie Schneider in dem Vortrag anhand von Screenshots aus dem internen Bugtracker des Unternehmens belegte, wurde die Einhaltung der Lizenzen zunächst auch schlicht nicht als wichtig genug betrachtet.
Das lag laut den Vortragenden klar am damaligen Fehlen des Open-Source-Ansatzes. Das Unternehmen hatte "wenig bis gar keine Erfahrung mit Elektronik oder Software", immerhin hat Gardena bisher fast ausschließlich mechanische Teile wie Schläuche, Brausen, Ventile oder Ähnliches hergestellt und vertrieben. Vorherrschend gewesen sei außerdem die Herangehensweise: "Wenn das Produkt fertiggestellt ist, ist es fertig". Die Idee, dass Software auch über zehn Jahre lang gepflegt und das Produkt dafür immer wieder angefasst werden muss, ist für ein Hardware-Unternehmen schwer verständlich.
Schneider versuchte, wie er erzählte, seinen Vorgesetzten klar zu machen, dass solch ein Desinteresse in Bezug auf die die Lizenzen das Geschäft mit dem Smart-Home-Geräten wie auch die Reputation des Unternehmens behindern oder gar zerstören könne. Zunächst seien seine Argumente im Unternehmen aber nicht erhört worden. Schneiders Einträge dazu im Bugtracker seien sogar in ihrer Priorität heruntergestuft worden - mit der Begründung, die Lizenzkonformität sei "kein Release Blocker".
Die Bemühungen um eine Lizenzkonformität waren letztlich dennoch erfolgreich. Dazu beigetragen hat dem Vortrag zufolge die breite Medienaufmerksamkeit der Klage des Entwicklers Patrick McHardy gegen den Elektronikhersteller Geniatech. Zwar wurde die Klage in zweiter Instanz wegen der wohl geringen Erfolgsaussichten zurückgezogen. In der Vorinstanz hatte das Landgericht Köln aber noch ein Ordnungsgeld von 250.000 Euro oder bis zu sechs Monaten ersatzweise Haft bei Nichteinhaltung der Lizenz angedroht.
Das wiederholte Drängen Schneiders sowie der Verweis auf den möglichen massiven Schaden für das Unternehmen bei Nichteinhaltung waren dann wohl ausschlaggebend dafür, dass Gardena schließlich den Bedingungen der GPL nachkam. Die Entwicklung des Codes kann auf Github nachvollzogen werden.
Vorbildwirkung kann der Vortrag auf zweifache Weise entfalten: Er könnte andere Firmen ermutigen, ebenfalls offener über ihre Probleme und die gefundenen Lösungen sprechen - was heute besonders bei solchen Unternehmen selten ist, die erst seit kurzem Software erstellen. Andererseits zeigt die Geschichte, wie Entwickler den Open-Source-Gedanken in ihren Unternehmen verbreiten können, insbesondere wenn diese Firmen keine klassischen Softwarehersteller sind.
Schneider und Müller zeigen nicht nur, wie Open Source aus rechtlicher Perspektive richtig gemacht werden kann, sondern auch, was das technisch bedeutet und wie es umgesetzt werden kann.
Um die Schritte auf dem Weg zu einem guten Open-Source-Ansatz für Geräte wie dem Smart Home System von Gardena verständlich zu machen, verglichen die Entwickler des Herstellers in ihrem Vortrag die erste und die zweite Generation miteinander.
Treibender Ansatz dabei war laut Müller die Devise, dass Kunden, "die die Geräte kaufen, diese auch tatsächlich besitzen". Im Geschäft mit Schläuchen und Brausen ist das eine Selbstverständlichkeit. Beim Vertrieb von Embedded-Geräten samt dazugehöriger Software aus Sicht der Nutzer häufig nicht - so auch bei der ersten Gardena-Generation.
Damals probierte Gardena noch, das Gerät durch technische Maßnahmen so zu sperren, dass Nutzer die darauf laufende Software nicht für eigene Zwecke verwenden und sich auch nicht einfach im Linux-System anmelden konnten. Diverse Anleitungen im Netz erklären inzwischen, wie dies umgangen wird. Die Erkenntnisse seien per Reverse Engineering entstanden und "besser als meine eigene Methode", sagte Müller.
Das Unternehmen davon zu überzeugen, von dieser Vorgehensweise Abstand zu nehmen, war laut Müller schwierig. Dass die Entwickler schließlich doch Gehör fanden, lag unter anderem daran, dass die Umsetzung eines zuverlässigen Lockdowns nicht nur technisch sehr anspruchsvoll ist, sondern auch teuer - was aus Sicht des Managements starke Argumente gegen solch ein Vorgehen sind.
Darüber hinaus habe das Entwickler-Team den Rest des Unternehmens von der Perspektive überzeugen können, dass eine Softwareabsicherung gegen lokale Angriffe auf das Gerät nicht relevant für die Angriffsszenarien auf das Smart System von Gardena sind, erzählten die Entwickler. Denn für einen erfolgreichen lokalen Angriff auf das Gateway müssten sich Angreifer bereits im Haus befinden, das Gerät aufschrauben und mit eigener Technik verbinden. Physisch den Wasserzulauf im Garten zu manipulieren, geht auch einfacher, als dies über einen lokalen Angriff auf das Gateway zu probieren.
Experimentierfreudige Bastler und Besitzer des Geräts erhalten deshalb einen passwortlosen Root-Zugriff auf die Linux-Firmware. Voraussetzung dafür ist allerdings, dass Pins für die UART-Schnittstelle auf das Board gelötet werden müssen und die Kommunikation dann auch über UART läuft.
Auch die Firmware des Geräts konnte das Team nach seinen eigenen Bedürfnissen und Ansprüchen gestalten, wobei der Open-Source-Gedanke treibend war. Grundlage für das Smart Gateway ist das Mediatek-SoC MT7688. Der vom Hersteller in China dazu ausgelieferte Support-Code - also etwa U-Boot zum Starten und der Linux-Kernel samt Treibern - sind teilweise mehr als zehn Jahre alt. Ein Upstream-Support war zu Projektbeginn nicht vorhanden.
Um das zu ändern, beauftragten die Gardena-Entwickler die U-Boot-Entwickler von Denx damit, den Support in den Hauptzweig zu integrieren. Ähnliches gilt auch für die Linux-Kernel- und Treiber-Patches, die teils aus OpenWRT übernommen wurden. So beauftragte das Team etwa den Maintainer Felix Fietkau des WLAN-Treibers Mt76 für das SoC mit dieser Aufgabe. Fietkau arbeitet an OpenWRT und pflegt dafür den Treiber.
Dank dieser Unterstützung habe das Team sehr schnell einige Probleme lösen können, etwa im Zusammenhang mit der WLAN-Zertifizierung oder mit dem SPI-Nand, erzählten Schneider und Müller. Diese Arbeiten an den Hauptzweigen hätten sie bei ihren Chefs mit dem Argument durchsetzen können, dass dies schlicht die Projektrisiken verringere, was sich rückblickend auch bestätigt habe.
Immerhin hätten die aufgetreten Fehler mit der Hardware durch das kleine Entwicklungsteam wohl nur schwer selbst oder gar nicht gelöst werden können. Die Mainline-Betreuer kennen sich in diesem Entwicklungsbereich besser aus und sind in der Problemlösung dann auch schneller. Das wiederum senkt einen Teil der Kosten für das Projekt - ebenso ein Argument, um das Management vom Mainline-Support zu überzeugen.
Für die Entwickler heißt das, dass sie künftig relativ problemlos zehn Jahre lang Updates für das Gerät pflegen und an Nutzer verteilen können. Und weil das Ganze für die aktuelle Generation des Smart Gateways offenbar so gut geklappt hat, plant das Team nun auch ein ähnliches Vorgehen für die erste Generation.
